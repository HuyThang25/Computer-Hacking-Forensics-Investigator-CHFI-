Cuộc điều tra về tội phạm qua email được tiến hành chủ yếu nhằm xem xét nội dung cũng như nguồn gốc của bất kỳ tin nhắn email nào bị xúc phạm hoặc nghi ngờ bị làm giả. Phần này định nghĩa việc điều tra tội phạm qua email và trình bày các bước mà các nhà điều tra cần tuân thủ trong quá trình điều tra các tội phạm qua email.

## Giới thiệu về Điều tra Tội phạm qua Email
Điều tra tội phạm qua email liên quan đến việc trích xuất, thu thập, phân tích và khôi phục các tin nhắn email liên quan đến bất kỳ tội phạm mạng nào. Phân tích chi tiết các tin nhắn email giúp các nhà điều tra thu thập bằng chứng hữu ích như thời gian và ngày gửi tin nhắn email, địa chỉ IP thực tế của người gửi và người nhận, và cơ chế làm giả đã được sử dụng. Các nhà điều tra cần sử dụng nhiều công cụ pháp y để trích xuất siêu dữ liệu từ tiêu đề email. Điều này giúp họ xác định được tội phạm đứng sau vụ việc và báo cáo kết quả để truy tố trong tòa án.

Các cuộc điều tra về hoạt động tội phạm hoặc vi phạm chính sách liên quan đến email tương tự như các cuộc điều tra về tội phạm máy tính khác. Tội phạm qua email có thể được phân loại theo hai cách: tội phạm gửi qua email và tội phạm được hỗ trợ bằng email. Khi các tội phạm sử dụng thư rác, email giả mạo, mail bombing hoặc mail storms để bán ma túy, theo dõi, gian lận, bắt cóc trẻ em hoặc thực hiện các hoạt động xấu xa khác, có thể nói rằng những email này hỗ trợ tội phạm mạng.
Hãy thảo luận chi tiết về tội phạm gửi qua email.

## Spam qua Email

Spam là những email thương mại không được yêu cầu hoặc rác. Thư rác liên quan đến việc gửi nội dung tương tự đến một số lượng lớn địa chỉ cùng một lúc. Spam hoặc thư rác làm đầy hộp thư và ngăn người dùng truy cập vào email thông thường của họ. Những email thông thường này bắt đầu trả về vì máy chủ vượt quá giới hạn dung lượng. Những kẻ gửi thư rác che giấu danh tính bằng cách làm giả tiêu đề email. Để tránh nhận được phản hồi từ người nhận tức giận, những kẻ gửi thư rác cung cấp thông tin sai lệch trong các trường FROM và REPLY-TO và đăng chúng vào danh sách gửi thư hoặc nhóm tin tức.

## Phishing (Lừa đảo qua Email)

Phishing đã trở thành một phương pháp hiệu quả để đánh cắp thông tin cá nhân và bí mật của người dùng. Đây là một hình thức gian lận trên Internet lừa người dùng tiết lộ thông tin cá nhân và bí mật của họ bằng cách đưa ra những tuyên bố và ưu đãi hấp dẫn. Kẻ lừa đảo có thể tấn công người dùng bằng cách gửi hàng triệu địa chỉ email trên toàn thế giới.

Cuộc tấn công lừa đảo qua email đánh lừa và thuyết phục người dùng bằng nội dung kỹ thuật giả mạo cùng với các phương pháp kỹ thuật xã hội. Nhiệm vụ chính của kẻ lừa đảo là khiến nạn nhân tin rằng các trang web lừa đảo là hợp pháp. Các nguồn có thể bị mạo danh bao gồm trang web, tin nhắn tức thì, email và Internet Relay Chat. Hầu hết các cuộc tấn công lừa đảo qua email được thực hiện thông qua email, trong đó người dùng nhận một email đánh lừa họ theo đường liên kết được cung cấp, dẫn họ đến một trang web lừa đảo. Email có thể chứa thông báo cho biết đã có giao dịch cụ thể từ tài khoản của người dùng và có thể chứa một liên kết để kiểm tra số dư hoặc có thể chứa một liên kết để thực hiện kiểm tra bảo mật cho tài khoản của người dùng.

Dưới đây là một số loại tấn công lừa đảo qua email:

- Spear Phishing: Đây là khi, thay vì gửi hàng ngàn email, một số kẻ tấn công sử dụng nội dung kỹ thuật xã hội chuyên biệt nhằm vào một nhân viên cụ thể hoặc một nhóm nhỏ nhân viên trong một tổ chức cụ thể để đánh cắp dữ liệu nhạy cảm như thông tin tài chính và bí mật thương mại. Tin nhắn spear phishing có vẻ như đến từ một nguồn đáng tin cậy với một trang web trông chính thức. Email cũng có vẻ như được gửi từ một cá nhân thuộc công ty của người nhận, thông thường là người có vị trí quyền lực. Tuy nhiên, tin nhắn thực sự được gửi bởi một kẻ tấn công cố gắng thu thập thông tin quan trọng về một người nhận cụ thể và tổ chức của họ, chẳng hạn như thông tin đăng nhập, chi tiết thẻ tín dụng, số tài khoản ngân hàng, mật khẩu, tài liệu bí mật, thông tin tài chính và bí mật thương mại. Spear phishing tạo ra tỷ lệ phản hồi cao hơn so với cuộc tấn công lừa đảo thông thường, vì nó có vẻ như đến từ một nguồn công ty đáng tin cậy.
- Whaling: Đây là một loại tấn công lừa đảo nhắm vào các cấp cao quan trọng như CEO, CFO, chính trị gia và người nổi tiếng có quyền truy cập đầy đủ vào thông tin nhạy cảm và có giá trị cao. Đây là một thủ đoạn kỹ thuật xã hội mà kẻ tấn công lừa đảo nạn nhân tiết lộ thông tin doanh nghiệp và cá nhân quan trọng (như chi tiết tài khoản ngân hàng, chi tiết nhân viên, thông tin khách hàng và chi tiết thẻ tín dụng), thông thường thông qua email hoặc giả mạo trang web. Whaling khác với cuộc tấn công lừa đảo, trong trường hợp này, email hoặc trang web được sử dụng cho cuộc tấn công được thiết kế cẩn thận để nhắm vào một người trong lãnh đạo điều hành cụ thể.
- Pharming: Đây là một kỹ thuật kỹ thuật xã hội trong đó kẻ tấn công thực hiện các chương trình độc hại trên máy tính hoặc máy chủ của nạn nhân. Khi nạn nhân nhập bất kỳ URL hoặc tên miền nào, nó tự động chuyển hướng lưu lượng của nạn nhân đến một trang web được kiểm soát bởi kẻ tấn công. Cuộc tấn công này còn được gọi là "Lừa đảo mà không có Lure": Kẻ tấn công đánh cắp thông tin nhạy cảm như thông tin đăng nhập, chi tiết ngân hàng và các thông tin khác liên quan đến dịch vụ trên web. Cuộc tấn công pharming có thể được thực hiện theo hai cách, gồm độc chiếm bộ nhớ cache Hệ thống tên miền (DNS) và sửa đổi tệp host.
- Spimming hoặc "spam over instant messaging" (SPIM) khai thác các nền tảng tin nhắn tức thì và sử dụng IM như một công cụ để lan truyền thư rác. Người tạo ra spam qua IM được gọi là "spimmer". Một spimmer thường sử dụng các bot (một ứng dụng thực hiện các tác vụ tự động trên mạng) để thu thập ID tin nhắn tức thì và gửi tin nhắn rác đến chúng. Tin nhắn SPIM, tương tự như thư rác qua email, thường bao gồm quảng cáo và phần mềm độc hại dưới dạng tệp đính kèm hoặc liên kết nhúng. Người dùng nhấp vào tệp đính kèm sẽ được chuyển hướng đến một trang web độc hại, thu thập thông tin tài chính và cá nhân như thông tin đăng nhập, tài khoản ngân hàng và chi tiết thẻ tín dụng.

## Mail Bombing 

Mail bombing đề cập đến quá trình gửi lại vài lần một tin nhắn email đến một địa chỉ cụ thể trên một trang web nạn nhân. Trong nhiều trường hợp, các tin nhắn sẽ chứa dữ liệu vô ích nhằm tiêu thụ nhiều tài nguyên hệ thống và mạng hơn.

Có thể lợi dụng nhiều tài khoản trên trang web mục tiêu, tăng cường tác động của cuộc tấn công từ chối dịch vụ. Mail bombing là một hành vi có chủ đích gửi nhiều bản sao của nội dung giống nhau cho cùng một người nhận. Mục tiêu của nó là quá tải máy chủ email và làm suy yếu hệ thống truyền thông bằng cách làm cho nó không thể sử dụng được. Thông thường, một mail bomber và nạn nhân biết nhau. Các bài đăng trên newsgroup không đồng ý với quan điểm của người nhận cũng dẫn đến mail bombing. Trong những trường hợp như vậy, mục tiêu có thể là một máy cụ thể hoặc một người cụ thể. Mail bombing tác động nghiêm trọng hơn so với spamming vì nó không chỉ gửi email với số lượng lớn cho một cá nhân mà còn làm gián đoạn hoạt động của máy chủ email, khiến người dùng khác không thể truy cập vào hộp thư của mình. 

## Mail Storms 

Một mail storm xảy ra khi các máy tính bắt đầu giao tiếp với nhau mà không có sự can thiệp của con người. Một cuồng phong email xảy ra khi một lỗi không đáng mong muốn gửi đi một lượng lớn thư rác. Các nguyên nhân gây ra cuồng phong email có thể bao gồm việc sử dụng danh sách gửi thư, chuyển tiếp tự động email, phản hồi tự động và sự hiện diện của nhiều địa chỉ email. Mã độc hại cũng có thể được viết để tạo ra cuồng phong email, ví dụ như thông điệp "Melissa, I-Care-For-U". Cuồng phong email gây trở ngại cho hệ thống giao tiếp và làm cho nó không thể hoạt động được.

## Gian lận danh tính

Gian lận danh tính là việc lấy trái phép và sử dụng dữ liệu cá nhân của người khác với mục đích độc hại và lợi ích tài chính. Trộm danh tính là một tội phạm đang nhanh chóng trở nên phổ biến. Đó là hành vi cố ý đánh cắp danh tính của người khác với mục đích lợi ích tài chính. Tội phạm thu thập thông tin cá nhân về một người và lạm dụng nó, gây thiệt hại tài chính nặng nề cho nạn nhân. Các trang web mua sắm trực tuyến với những sự biểu đạt sai lệch và các email rác chứa những ưu đãi không thể cưỡng lại là những phương tiện thông thường được sử dụng để thu thập số thẻ tín dụng của nạn nhân. Sau khi người dùng đã đặt hàng trực tuyến, tội phạm có thể chặn email và sử dụng nó. Tội phạm không chỉ rút tiền lớn từ tài khoản của nạn nhân mà còn có thể khiến nạn nhân phá sản.

## Quấy rối trực tuyến

Quấy rối trực tuyến là một tội phạm mà kẻ tấn công gây phiền nhiễu cho một cá nhân, một nhóm hoặc một tổ chức bằng cách sử dụng email hoặc tin nhắn tức thì (IMs). Kẻ tấn công cố gắng đe dọa, yêu cầu quan hệ tình dục, đưa ra cáo buộc sai sự thật, bôi nhọ, phỉ báng, xúc phạm danh dự hoặc đánh cắp danh tính của nạn nhân/những nạn nhân như một phần của việc quấy rối trực tuyến. Kẻ theo dõi có thể là ai đó liên quan đến nạn nhân hoặc một người lạ.

## Bắt cóc trẻ em

Bắt cóc trẻ em là tội phạm vi phạm việc bắt trái phép, giữ lại, giam cầm hoặc che giấu một đứa trẻ hoặc em bé. Bắt cóc được xác định là việc mang đi một người bằng sự thuyết phục, gian lận, bạo lực hay ác liệt. Có hai loại bắt cóc trẻ em: bắt cóc trẻ bởi cha mẹ và bắt cóc bởi một người lạ. Bắt cóc trẻ bởi cha mẹ là loại phổ biến nhất, trong khi bắt cóc bởi một người lạ sẽ được phân loại như là tội bắt cóc.

## Các bước để điều tra tội phạm qua email

Để có thể tìm kiếm, trích xuất và phân tích các bằng chứng liên quan đến email, một nhà điều tra phải tuân theo một loạt các bước được xác định và thực hành. Điều này không chỉ giúp dễ dàng quá trình thu thập bằng chứng mà còn giúp nhà điều tra duy trì tuân thủ và tính toàn vẹn.

Một số bước quan trọng cần tuân theo trong quá trình điều tra tội phạm qua email như sau:

1. Tịch thu máy tính và tài khoản email
2. Lấy dữ liệu email
3. Khám phá thông điệp email
4. Trích xuất tiêu đề email
5. Phân tích tiêu đề email
6. Khôi phục các thông điệp email đã bị xóa

### Bước 1: Tịch thu máy tính và tài khoản email

Để tiến hành khám phá trên hiện trường máy tính và máy chủ email, nhà điều tra nên xin cấp giấy phép tìm kiếm bằng ngôn ngữ phù hợp. Sau đó, họ nên thực hiện kiểm tra pháp lý trên các thiết bị được phép, như đã được đề cập trong giấy phép. Tất cả các máy tính và tài khoản email được nghi ngờ liên quan đến tội phạm nên được tịch thu. Nhà điều tra có thể tịch thu các tài khoản email bằng cách thay đổi mật khẩu hiện tại - thông qua việc yêu cầu mật khẩu từ nạn nhân hoặc thu được từ máy chủ email.

Nếu nạn nhân là một tổ chức doanh nghiệp, thì nhà điều tra nên xin phép từ các cơ quan có thẩm quyền và hợp tác với các quản trị mạng và hệ thống nội bộ để hiểu về chính sách và tuân thủ quy định an toàn dữ liệu của họ.

### Bước 2: Thu thập dữ liệu email

Sau khi máy tính và tài khoản email đã được tịch thu, bước tiếp theo là thu thập dữ liệu email để phân tích pháp y. Quá trình thu thập dữ liệu email phụ thuộc vào các tình huống sau đây:

- Nghi phạm đã truy cập email thông qua các ứng dụng email trên máy tính như Outlook và Mozilla Thunderbird.
- Nghi phạm có một tài khoản email trực tuyến mà họ truy cập qua trình duyệt.

Nhà điều tra cần chọn quy trình thu thập phù hợp với tình huống tại hiện trường tội phạm.

#### Thu thập dữ liệu email từ các ứng dụng email trên máy tính

Nhiều người dùng thích sử dụng các ứng dụng email trên máy tính như Microsoft Outlook, Mozilla Thunderbird và Apple Mail để gửi/nhận email. Khi có nghi vấn về tội phạm email xảy ra trên máy tính người dùng sử dụng các ứng dụng email này, các nguồn chính của bằng chứng là các thư mục cục bộ và các tệp lưu trữ được lưu trữ bởi các chương trình này chứa thông tin về tất cả các hoạt động email. Nhiệm vụ của nhà điều tra pháp y là xác định các thư mục cục bộ và trích xuất tất cả các email bằng cách sử dụng công cụ pháp y đúng và lưu các bản sao ở một vị trí an toàn.

Các tệp email cục bộ/cơ sở dữ liệu được tạo bởi các ứng dụng email có thể được lưu trữ ở các vị trí khác nhau trên máy tính của nghi phạm. Nhà điều tra cần xác định cẩn thận tất cả các tệp email cục bộ và thu thập các email liên quan đến tội phạm một cách thích hợp.

### Tệp Email Cục bộ trong Microsoft Outlook

Khi một tài khoản email được đồng bộ với ứng dụng máy tính Outlook của Microsoft, nó tạo ra một bản sao cục bộ của tất cả các thư mục email theo hai định dạng sau:

#### Personal Storage Table (.pst)

Thường thì, các tài khoản pop lưu trữ tất cả thông tin email trong định dạng tệp .pst trong Outlook. Các email, danh bạ, lịch và dữ liệu nhiệm vụ khác được tự động tải về từ máy chủ email và được lưu trữ cục bộ trên ổ cứng. Trong Outlook 2013 và các phiên bản trước đó, tệp .pst được sử dụng cho các tài khoản IMAP.

Tuy nhiên, trong Outlook 2016, các email của tất cả các tài khoản IMAP được lưu trữ trong định dạng tệp .ost. Vị trí mặc định của tệp .pst trong Outlook 2016 là: C:\Users\%USERNAME%\Documents\Outlook Files

#### Offline Storage Table (.ost)

Các loại tài khoản như Outlook.com, Outlook cho Office 365, Microsoft Exchange và IMAP sao chép tất cả các thành phần hộp thư vào định dạng tệp .ost.

Do các email, danh bạ, lịch và dữ liệu khác không được gỡ ra khỏi máy chủ như các tài khoản pop, người dùng có thể truy cập vào email của mình ngay cả khi không có kết nối Internet. Tất cả thông tin hộp thư được cập nhật khi kết nối được khôi phục.

Theo mặc định, tệp .ost trong Outlook 2016 được lưu tại vị trí sau: C:\Users\%USERNAME%\AppData\Local\Microsoft\Outlook.

### Lưu trữ trong Microsoft Outlook

Nhà điều tra cũng có thể trích xuất các dấu vết liên quan đến email từ các lưu trữ, một thư mục mặc định được tạo bởi ứng dụng Outlook cho phép người dùng lưu trữ email cũ. Tính năng AutoArchive có sẵn trong các phiên bản Outlook 2013, 2016 và 2019, cho phép người dùng tự động lưu trữ email vào khoảng thời gian đều đặn. Các tệp lưu trữ này được lưu trữ trong định dạng tệp .pst.

Để xác định vị trí của tệp lưu trữ Outlook, nhà điều tra cần có thông tin đăng nhập của nghi phạm, mở ứng dụng Outlook và điều hướng đến File-> Options->Advanced->AutoArchive->Settings.


### Tệp Email Cục bộ trong Mozilla Thunderbird

Mozilla Thunderbird là một ứng dụng email phổ biến. Khi người dùng cấu hình một tài khoản email với Thunderbird, nó tạo ra một thư mục Profiles ở vị trí sau theo mặc định: C:\Users%USERNAME%\AppData\Roaming\Thunderbird\Profiles

Trong thư mục Profiles, Thunderbird lưu trữ một bản sao cục bộ của tất cả các email và bất kỳ thay đổi cấu hình nào được thực hiện bởi người dùng, chẳng hạn như các thay đổi trong Cài đặt Tài khoản. Thunderbird tạo ra một thư mục Profile mặc định khi được cài đặt và có thể tạo ra nhiều tệp hồ sơ khác nhau tùy thuộc vào cách sử dụng. Mỗi hồ sơ có quy ước đặt tên như sau: <Chuỗi số ngẫu nhiên gồm tám chữ số>.<tên_hồ_sơ>

Người dùng có thể cấu hình cả tài khoản email POP3 và IMAP trong Thunderbird. Một thư mục con có tên "ImapMail" được tạo ra để lưu trữ các hồ sơ email IMAP, trong khi các email POP3 và các thư mục cục bộ khác được lưu trữ riêng biệt trong một thư mục con khác gọi là "Mail."

Trong Thunderbird, tất cả các email trong các thư mục email khác nhau, như được tìm thấy trên giao diện người dùng, được lưu trữ dưới dạng các tệp MBOX không có phần mở rộng. Cũng có các tệp tóm tắt email hoặc các tệp .msf được tìm thấy cùng tên với các tệp MBOX, được sử dụng để lưu trữ chỉ mục của các email. Ví dụ, nội dung của thư mục Hộp thư đến được lưu trữ trong một tệp mbox có tên là INBOX mà không có phần mở rộng tệp.

Thunderbird sử dụng một thư mục con hoặc thư mục SBD để lưu trữ chỉ mục và email trong định dạng MBOX và MSF. Tên của thư mục "SBD" phụ thuộc vào loại tài khoản email được cấu hình trong Thunderbird. Ví dụ, nếu thư mục "SBD" được tạo cho Gmail, Thunderbird sẽ tạo ra một thư mục Gmail.sbd.

Nếu người dùng muốn lưu trữ một bản sao cục bộ của email để giải phóng không gian lưu trữ, họ có thể di chuyển email đó vào Local Folder, một thư mục mặc định được tạo bởi Thunderbird. Thư mục Local Folders có thể được tìm thấy ở vị trí mặc định sau nếu Thunderbird được cài đặt và cấu hình với bất kỳ tài khoản người dùng nào:
C:\Users%USERNAME%\AppData\Roaming\Thunderbird\Profiles<Tên hồ sơ>\Mail

Có hai thư mục chính trong Local Folders:

- Trash: Thường được sử dụng như một thư mục "Archive" để lưu trữ các email cục bộ.
- Unsent Messages: Được sử dụng để lưu trữ nội dung của thư mục outbox hoặc các tin nhắn đã được soạn nhưng chưa được gửi đi.

Trong trường hợp của bất kỳ tài khoản Thunderbird nào được cấu hình với POP3, tất cả các email mới đều được tự động tải xuống và lưu trữ trong các thư mục cục bộ và không còn trên máy chủ.

Người dùng có tài khoản IMAP có thể chọn tạo một thư mục "Archive" trong Thunderbird để sao lưu cục bộ các email quan trọng. Tệp lưu trữ cục bộ được lưu trữ theo đường dẫn mặc định C:\Users%USERNAME%\AppData\Roaming\Thunderbird\Profiles<Tên hồ sơ>\Mail\Local Folders. Tuy nhiên, người dùng cũng có thể lưu tệp lưu trữ này ở các vị trí khác.

Để xác định vị trí của thư mục "Archive", các nhà điều tra có thể đăng nhập vào ứng dụng email Thunderbird bằng thông tin đăng nhập của nghi phạm, sau đó điều hướng đến Cài đặt -> Cài đặt tài khoản -> Sao chép và Thư mục, và kiểm tra đường dẫn được cung cấp trong mục lưu trữ tin nhắn (như minh họa trong hình dưới đây).

### Thu thập các tệp email cục bộ của Thunderbird bằng SysTools MailPro+

Như một nhà điều tra pháp y, bạn có thể sử dụng các công cụ như SysTools MailPro+ để thu thập dữ liệu từ các tệp email địa phương được lưu trữ bởi Thunderbird. Bạn có thể chọn một hoặc nhiều tệp mbox hoặc các thư mục email địa phương cụ thể để thu thập và phân tích pháp y.

Để lấy các tệp email cục bộ của Thunderbird bằng cách sử dụng SysTools MailPro+, hãy thực hiện các bước chung sau:

- Cài đặt phần mềm SysTools MailPro+ trên máy tính của bạn.
- Khởi chạy phần mềm và chọn tùy chọn "Thêm tệp" hoặc "Thêm thư mục" để thêm các tệp email cục bộ của Thunderbird.
- Trong cửa sổ trình duyệt tệp, điều hướng đến vị

#### SysTools Maipro+

Source: https://www.systoolsgroup.com

SysTools MailPro+ là một công cụ đa năng và đa nhiệm để xem trước, tìm kiếm và xuất email từ nhiều client email khác nhau.

Các tính năng của nó bao gồm:
- Hỗ trợ hơn 12 định dạng tệp email khác nhau.
- Đọc hộp thư của bất kỳ định dạng tệp email nào.
- Tìm kiếm email trong các tệp email nguồn chỉ trong vài cú nhấp chuột.
- Tạo và lưu trữ bộ sưu tập để quản lý hộp thư dễ dàng.
- Tìm kiếm và trích xuất email từ ổ cứng hoặc thiết bị lưu trữ bên ngoài.
- Thêm tệp vào ba chế độ khác nhau trên bảng điều khiển của phần mềm.
- Xuất email sang các định dạng tệp .pst, .pdf, .msg, .html, .eml, .tiff và .csv.
- Xem trước các loại tệp đính kèm như JPG, GIF, PNG, DOC và PDF.

#### Xem trước Email

Công cụ này cung cấp khả năng xem trước email trong các chế độ khác nhau như sau:

- Xem Hex thông thường: Nó hiển thị email cùng với các thuộc tính như To, CC, BCC, Subject, Ngày và Giờ
- Xem Hex: Nó hiển thị email dưới dạng mã hex theo từng bit
- Xem thuộc tính: Nó hiển thị các thuộc tính liên quan đến email như các cờ tin nhắn, người nhận và người gửi
- Xem tiêu đề tin nhắn: Nó cung cấp chi tiết xem như X-Priority, Message ID, Thread-Index, Content-Type và các thông tin khác
- Xem MIME: Nó hiển thị email dưới định dạng MIME với các chi tiết khác nhau
- Xem HTML: Nó hiển thị email dưới dạng HTML với tất cả các thẻ và nội dung
- Xem RTF: Nó cung cấp khả năng xem trước email dưới dạng văn bản thuần túy
- Xem đính kèm: Cho phép người dùng xem các tệp đính kèm trong email
- Xem theo cấu trúc phân cấp: Nó hiển thị cấu trúc phân cấp của thư mục chứa tệp nguồn

### Acquiring Outlook Email Files: Chuyển đổi file .ost sang .pst

Chuyển đổi file .ost sang định dạng .pst cung cấp cho nhà điều tra một cách dễ dàng để thu thập dữ liệu email được lưu trữ bởi ứng dụng email Outlook. Bạn có thể sử dụng các công cụ như kernel for OST to PST để thực hiện việc này.

#### Kernel for OST to PST

Nguồn: https://www.nucleustechnologies.com

Kernel for OST to PST có thể dễ dàng chuyển đổi các file OST sang định dạng PST và các định dạng khác như PST, EML, MSG, Office 365 và Exchange Server. Công cụ này cho phép lưu các file OST vào các máy chủ email, các ứng dụng email trực tuyến bao gồm Office 365. Nó đi kèm với bộ lọc giúp lựa chọn các mục cụ thể để di chuyển.

Các tính năng:
- Chuyển đổi các file OST mồ côi sang PST (cho bất kỳ phiên bản Outlook nào)
- Chuyển đổi các file OST có kích thước lớn
- Khôi phục dữ liệu người dùng từ các file OST mồ côi
- Khôi phục các mục hộp thư Outlook đã bị xóa vĩnh viễn
- Hiển thị các email OST và chuyển đổi chúng với tính toàn vẹn hoàn chỉnh
- Khôi phục các email Exchange vào tài khoản Gmail/Outlook.com
- Tìm kiếm và lưu các email cần thiết vào ví dụ, file PST, MBOX, PDF, DBX và EML/MSG
- Xuất dữ liệu OST vào Exchange trực tiếp và Office 365
- Khôi phục và xuất các file .nst thành các file .pst, Exchange trực tuyến và Office 365
- Sửa chữa các file OST bị hỏng trước khi chuyển đổi
- Cung cấp khôi phục hộp thư an toàn cho các email hiện có/đã bị xóa, tệp đính kèm, các mục lịch, vv.

#### Phiên bản được hỗ trợ

MS Exchange Server - 2019/2016/2013/2010/2007/2003/2000/5.5 và 5.0, MS Outlook - Office 365/2019/2016/2013/2010/2007/2003/2002/2000/98 và 97 và Outlook Express - 6.0/5.5/5.0 và 4.0

#### Yêu cầu hệ điều hành

Windows 10, 8.1, 8, 7, Vista, XP, 2000, 98, NT, 95, Windows Server 2016/2012/2008 R2/2008/2003 R2/2003

### Thu thập file .pst Outlook bằng SysTools MaiPro+

Bạn cũng có thể sử dụng SysTools MailPro+ để xem nội dung của tệp .pst và giải nén tất cả các email. Nhận thông báo email bằng cách nhấp vào nút 'Xuất' và lưu chúng vào vị trí mong muốn.

Các hình bên dưới mô tả việc xem tất cả các thư mục và email của tệp .pst liên quan đến tài khoản email đáng ngờ bằng SysTools MailPro+ và xuất các email đã chọn sang vị trí mong muốn cho mục đích thu thập.

### Thu thập dữ liệu email từ tài khoản email trên web

Trong quá trình điều tra tội phạm email, bước đầu tiên của nhà điều tra pháp y là thu thập dữ liệu email để thực hiện phân tích pháp y. Tuy nhiên, nhà điều tra pháp y cần có thông tin đăng nhập của nghi phạm để có thể thu thập dữ liệu email từ tài khoản email trên web (web-based email accounts). Nhà điều tra có thể sử dụng các phương pháp sau để thu thập bằng chứng email cho quá trình điều tra:

- Sử dụng Google Takeout để tạo bản sao lưu ngoại tuyến của tài khoản Gmail của nghi phạm trong định dạng tệp mbox.
- Đồng bộ hóa tài khoản email trên web với các ứng dụng email như Outlook hoặc Thunderbird để tạo bản sao dữ liệu email trên máy tính và thu thập chúng bằng các công cụ pháp y. Quá trình này sử dụng đồng bộ hóa POP3/IMAP. Để đảm bảo tính toàn vẹn của dữ liệu, nhà điều tra pháp y cần đảm bảo rằng dữ liệu không bị thay đổi trong quá trình đồng bộ hóa và sau khi đồng bộ hóa với ứng dụng email.

Lưu ý: Email trên web là một phần của dịch vụ đám mây và quá trình điều tra của chúng cũng sẽ liên quan đến sự hợp tác từ nhà cung cấp dịch vụ đám mây.

## Bước 3: Khám phá các thông điệp email

Nhà điều tra pháp y nên kiểm tra kỹ các phần sau đây khi điều tra các thông điệp email đã thu thập được:

1. Tiêu đề: Trường này của một email thông báo cho người nhận về nội dung chính của thông điệp. Hầu hết các email giả mạo được thiết kế để tạo ra cảm giác hoảng loạn/gấp rút, khiến nạn nhân mở email và đọc nội dung của nó.
2. Địa chỉ email của người gửi: Kẻ tấn công lừa người dùng mục tiêu bằng cách làm cho các email đáng ngờ trông giống như hợp pháp. Ví dụ, một email xuất hiện dưới tên của một ngân hàng, nhưng sử dụng một tài khoản Gmail thay vì miền của ngân hàng tương ứng, là một dấu hiệu mạnh về việc giả mạo.
3. Nội dung email: Phần thân email chứa thông điệp chính của email. Một email giả mạo có thể bao gồm các liên kết/trang web mà kẻ tấn công sử dụng để lừa người dùng cung cấp thông tin nhạy cảm. Thân email của một email giả mạo thường có ngôn ngữ/câu trúc kém chuyên nghiệp, không xuất hiện chuyên nghiệp.
4. Tệp đính kèm email: Kẻ tấn công thường gửi các tài liệu hoặc bản sao pdf với các phần mở rộng như .exe, .vbs, .js, .wsf và .zip là tệp đính kèm trong email. Những tệp đính kèm này được thiết kế để thực thi các chương trình ẩn như phần mềm gián điệp và phần mềm độc hại trên hệ thống tính toán của người dùng, có thể đe dọa dữ liệu nhạy cảm.

Lưu ý: Tham khảo Mô-đun 14 Pháp y malware để phân tích chi tiết các tệp đính kèm/tài liệu đáng ngờ.

### Bước 4: Lấy thông tin tiêu đề email

Tiêu đề email là một thành phần quan trọng của một email có thể giúp nhà điều tra xác định nguồn gốc của một email. Các tiêu đề này cung cấp thông tin về người gửi và người nhận email. Các chi tiết về nguồn gốc và người nhận được cung cấp bằng cách sử dụng các tiêu đề "From" và "To" tương ứng.

Các tiêu đề cũng chứa thông tin về quá trình mà email đi qua trong quá trình truyền. Mỗi MTA (Mail Transfer Agent) nhận thông điệp email khi nó di chuyển từ nguồn đến đích, sẽ thay đổi phần tiêu đề email. Do đó, nhà điều tra nên kiểm tra phần tiêu đề email và thu thập dữ liệu quan trọng có giá trị chứng cứ và truy tìm kẻ phạm tội.

Nhà điều tra có thể lấy thông tin tiêu đề từ bất kỳ thông điệp email nào sau khi đã thu thập được nó. Trong trường hợp họ có quyền truy cập vật lý vào hệ thống của đối tượng, họ có thể sử dụng chương trình email giống như chương trình được đối tượng sử dụng để xem các email. Quy trình lấy thông tin tiêu đề email khác nhau trong mỗi chương trình email.

#### Lấy thông tin tiêu đề email trong Microsoft Outlook

Các bước dưới đây liên quan đến ứng dụng Microsoft Outlook phiên bản desktop 2016:

1. Khởi chạy ứng dụng Microsoft Outlook trên máy tính
2. Xem qua tất cả các email trong tài khoản email của đối tượng và nhấp đúp vào email mà bạn muốn lưu
3. Nhấp vào nút File ở góc trên bên trái và sau đó chọn biểu tượng Properties.
4. Khi cửa sổ Properties mở ra, chọn văn bản tiêu đề tin nhắn từ ô Internet headers.
5. Sao chép và dán văn bản vào bất kỳ trình soạn thảo văn bản nào và lưu file lại.

Do đó, bạn có thể lưu văn bản tiêu đề tin nhắn của tất cả các email cần thiết để tiến hành điều tra tiếp về chúng.

#### Lấy thông tin tiêu đề email trong Microsoft Outlook.com

Các bước dưới đây liên quan đến ứng dụng web Microsoft Outlook.com:

1. Đăng nhập vào Microsoft Outlook.com
2. Nhấp vào email mà bạn muốn xem tiêu đề
3. Nhấp vào nút Thêm hành động (More actions), di chuột đến tùy chọn Xem chi tiết tin nhắn (View message details) và nhấp vào đó
4. Chọn văn bản tiêu đề tin nhắn từ ô Chi tiết tin nhắn (Message details), sau đó sao chép và dán văn bản vào bất kỳ trình soạn thảo văn bản nào và lưu file lại.

#### Lấy thông tin tiêu đề email trong AOL

1. Đăng nhập vào AOL Mail và nhấp chuột phải vào email đã nhận hoặc email mà bạn muốn xem tiêu đề
2. Di chuột đến tùy chọn Xem nguồn tin nhắn (View Message Source)
3. Chọn văn bản tiêu đề tin nhắn, sau đó sao chép và dán văn bản vào bất kỳ trình soạn thảo văn bản nào và lưu file lại.

#### Lấy thông tin tiêu đề email trong Apple Mail

1. Mở Apple Mail.
2. Chọn email đã nhận mà bạn muốn xem tiêu đề.
3. Điều hướng đến View Message All Headers (Xem toàn bộ tiêu đề tin nhắn).
4. Chọn văn bản tiêu đề tin nhắn.
5. Sao chép và dán văn bản vào bất kỳ trình soạn thảo văn bản nào và lưu file lại.

#### Lấy thông tin tiêu đề email trong Gmail

1. Đăng nhập vào tài khoản Gmail.
2. Chọn email đã nhận mà bạn muốn xem tiêu đề.
3. Nhấp vào nút More (Thêm) và điều hướng đến Show original (Hiển thị nguyên bản).
4. Chọn văn bản tiêu đề tin nhắn, sao chép và dán nội dung vào bất kỳ trình soạn thảo văn bản nào, sau đó lưu lại file.

#### Lấy thông tin tiêu đề email trong Yahoo Mail

1. Đăng nhập vào tài khoản Yahoo Mail.
2. Chọn email đã nhận mà bạn muốn xem tiêu đề.
3. Nhấp chuột phải vào tin nhắn email và điều hướng đến tùy chọn View raw message (Xem tin nhắn nguyên bản).
4. Chọn văn bản tiêu đề tin nhắn, sao chép và dán nội dung vào bất kỳ trình soạn thảo văn bản nào, sau đó lưu lại file.

### Bước 5: Phân tích Tiêu đề Email

Phân tích tiêu đề email là một khía cạnh quan trọng trong điều tra tội phạm qua email, vì chúng chứa dữ liệu siêu dữ liệu và thông tin khác về email. Các chi tiết sau đây được chứa trong tiêu đề email:

1. Mốc thời gian

  Đây là thời điểm và ngày gửi email.

2. Từ

  Tiêu đề này hiển thị địa chỉ email của người gửi như được nhìn thấy ở đầu nhận. Tiêu đề "Từ" có thể bị làm giả trong trường hợp của các email spam.

3. Đến

  Tiêu đề này hiển thị địa chỉ email của người nhận.

4. Message ID

  Mỗi email có một ID duy nhất được liên kết với nó. Không có hai email, ngay cả trong cùng một chuỗi email, có thể có cùng một Message ID. Những Message ID này được tạo ra bởi MTA/mail server duy nhất toàn cầu của hệ thống gửi email. Message ID duy nhất toàn cầu của một email là một chỉ báo về tính xác thực của nó. Phần trước "@" trong một Message ID biểu thị thời gian dựa vào email cụ thể đó. Phần sau "@" biểu thị tên miền đầy đủ (FQDN) thể hiện tên miền của bất kỳ máy chủ nào đánh dấu sự hiện diện duy nhất của nó trên mạng.

  Chủ đề

  Tiêu đề này hiển thị chủ đề được người gửi cung cấp.

5. MIME

Phần mở rộng Gửi đa mục đích trên Internet (MIME) cho phép người dùng email gửi các tệp đa phương tiện như âm thanh, video và hình ảnh như một phần của email.

Ví dụ về Tiêu đề MIME

- MIME-Version: Tiêu đề này cho thấy rằng tin nhắn được định dạng MIME. Mặc định, tiêu đề này được đặt giá trị là 1.0.
- Content-Type: Tiêu đề này chỉ định kiểu nội dung và phụ loại trong một tin nhắn như sau:
  - Text/plain hiển thị kiểu tin nhắn
  - Audio/mp3, image/jpeg, video/mp4, lần lượt đại diện cho tin nhắn email chứa các tệp âm thanh, hình ảnh và tệp video
  - Multipart/signature cho thấy rằng một tin nhắn email có một chữ ký
  - Multipart/mixed cho biết rằng một email có văn bản kèm theo tệp đính kèm
- Content Disposition: Tiêu đề này xác định cách một tin nhắn hoặc một phần cơ thể của nó phải được trình bày
- Content-Transfer Encoding: Tiêu đề này đại diện cho mã hóa chứa trong tin nhắn
- Content Description: Đây là một tiêu đề MIME tùy chọn được sử dụng để cung cấp thông tin bổ sung liên quan đến nội dung của một email.

6. Received Headers

Tiêu đề nhận (Received Headers) chứa chi tiết về tất cả các máy chủ thư mà một email đi qua trong quá trình truyền tải. Các tiêu đề này được tạo ra mỗi khi một email truyền qua một máy chủ thư/MTA trên đường đi đến người nhận.

Khi một máy chủ SMTP nhận được một email, một tiêu đề nhận được (received header) sẽ được thêm vào email. Trên tiêu đề email, các tiêu đề nhận được được đặt theo thứ tự ngược, tức là tiêu đề nhận được gần đây nhất hoặc mới nhất xuất hiện đầu tiên (ở phía trên, được đánh dấu bằng A trong hình dưới đây), và tiêu đề nhận được được tạo ra đầu tiên xuất hiện cuối cùng (ở phía dưới, được đánh dấu bằng B trong hình dưới đây).

Do đó, các nhà điều tra cần bắt đầu xem xét tiêu đề nhận được ở dưới cùng, vì nó phản ánh thông tin về máy chủ thư của người gửi. Sau đó, họ có thể tiếp tục lên phía trên, cung cấp cho họ dữ liệu về máy chủ thư và địa chỉ IP liên quan đến người nhận.

Trong hình dưới đây, tiêu đề B hiển thị tên miền từ email được gửi đi (sonic302-19.consmr.mail.sg3.yahoo.com), địa chỉ IP liên quan (106.10.242.139) và ngày giờ theo múi giờ PDT.

7. Return-Path:

Tiêu đề này được sử dụng để chỉ định địa chỉ email mà một email sẽ được gửi/được trả lại nếu không thể đến được người nhận dự định. Khi một email không thể đến được người nhận dự định, nó sẽ bị trả lại cho người gửi của email, trừ khi người gửi chỉ định một địa chỉ email khác nơi các email bị trả lại sẽ được gửi đến. Nếu địa chỉ đường trả lại khác với địa chỉ email của người gửi, đây là một dấu hiệu của thư rác/giả mạo.

8. Received-SPF:

SPF (Sender Policy Framework) là một cơ chế ngăn chặn việc giả mạo địa chỉ người gửi. SPF cho phép tổ chức chỉ định các máy chủ có thể gửi email thay mặt cho miền của họ. Cơ chế này thực hiện một bản ghi SPF, liên quan đến một bản ghi DNS được thêm vào vùng DNS của miền của tổ chức. Trong bản ghi SPF, tổ chức có thể xác định tên máy chủ và/hoặc địa chỉ IP được ủy quyền để gửi email từ miền của họ. Qua việc triển khai SPF, kết quả trao đổi email có thể như sau:

- Received-SPF: None: Điều này có nghĩa là không tìm thấy bản ghi SPF cho miền.
- Received-SPF: Neutral: Điều này có nghĩa là địa chỉ IP của người gửi không được ủy quyền hoặc bị hạn chế gửi email thay mặt cho miền của tổ chức. Kết quả trung lập được xem xét theo cùng một cách như kết quả "None".
- Received-SPF: Pass: Điều này có nghĩa là địa chỉ IP của người gửi được ủy quyền gửi email từ miền.
- Received-SPF: Fail hoặc Hard fail: Điều này có nghĩa là email bị từ chối bởi máy chủ thư của người nhận vì địa chỉ IP của người gửi không được ủy quyền gửi email từ miền. SPF hard fail được thực hiện bằng cách thêm cơ chế "-all" vào bản ghi SPF.

  Ví dụ: v=spf1 ip4: 207.84.200.37 -all

  Trong ví dụ trên, "-all" có nghĩa là người gửi không được liệt kê trong bản ghi DNS được nêu ra (tức là 207.84.200.37) sẽ được xem là không ủy quyền và các email từ họ sẽ bị từ chối. Chỉ có địa chỉ IP 207.84.200.37 được ủy quyền gửi email.
- Received-SPF: Softfail: Điều này có nghĩa là có khả năng địa chỉ IP có thể hoặc không thể được ủy quyền gửi email thay mặt cho miền được đề cập.

  

  Ví dụ: v=spf1 include:modprod.outlook.com ~all

  Trong ví dụ trên, ký hiệu "~" cho biết rằng email đến từ bất kỳ máy chủ nào không được đề cập ở đây sẽ được gửi đi nhưng coi như là softfail. Trong trường hợp này, nhà cung cấp hộp thư đánh dấu tin nhắn là thư rác hoặc thư rác điện tử. Chỉ có email đến từ Microsoft Office 365 sẽ được đánh dấu là SPF PASS.

9. Chữ ký DomainKeys Identified Mail (DKIM):

DomainKeys Identified Mail (DKIM) là phương pháp xác thực email giúp bảo vệ người gửi và người nhận email khỏi các hình thức lừa đảo, giả mạo và gửi thư rác (spam). Kỹ thuật này xác minh rằng email nhận được bởi người nhận đã được gửi từ một máy chủ email hợp lệ. Phương pháp xác thực email này sử dụng mã hóa khóa công khai để phát hiện và ngăn chặn việc gửi email độc hại. Chữ ký DKIM này được bảo vệ thông qua quá trình mã hóa. DKIM cũng đảm bảo rằng email và nội dung của nó không bị thay đổi trong quá trình truyền tải giữa máy chủ người gửi và máy chủ người nhận. Hầu hết các nhà cung cấp dịch vụ email đều tìm kiếm chữ ký DKIM trong email.

Máy chủ email nhận được email có thể xác minh chữ ký DKIM của người gửi bằng cách sử dụng khóa mật mã công khai đã đăng ký trong DNS. Máy chủ đích sử dụng khóa công khai này để giải mã chữ ký (giá trị băm) và xác minh nó với giá trị băm được tính mới. Nếu hai giá trị băm khớp nhau, thì tin nhắn được coi là xác thực và không bị thay đổi.

Ví dụ về một tiêu đề chữ ký DKIM:

```
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
d=gmail.com; s=20161025pm;
h=mime-version:from:date:message-id:subject:to;
bh=RqIJ8naev02DhEPJtlFAsdUqiGR7RyzmJ9cSxw5KzCY=;
b=BYQQZk7S77sJJef1WEXGyTmfb8sUF6S7W8wi93lhh7WthcGjc2lk/NfpgqVpeXrhHP Ujuv36G1DVe6TBzdHsjdDLzs4b3sATMSAZNZAEdA44Tm5ooGJbhBQ8iNjRgD7eYWeEPL cF0U/eBBU1Nteh9MOqxIBJYJ1ZHGB+dz9zyfsyQAiHik3Db1GLhXCvfYdkEWydjGN2CH 7/IdO3IJccF5z5sVwPYDz69dCKmyl3IWckXU/KU+xRVX4NjffZoWHBoxOK47H7YcJZye aFoeirs/UJVZH2xKZcjSMhBS9Q/4GAuACp5ehT2GtM7BoQB/H4wVV7gdQrrHjBUEwJGX lDIQ=
```

Phân tích các phần khác nhau của tiêu đề chữ ký DKIM được cho như sau:

- `v=1`: Chỉ ra phiên bản DKIM với giá trị là 1.
- `a=rsa-sha256`: Trường "a=" cho biết thuật toán băm được sử dụng để tạo ra khóa riêng tư hoặc khóa công khai. rsa-sha1 và rsa-sha256 là hai thuật toán chữ ký chính thức được hỗ trợ để tạo ra giá trị băm cho khóa riêng tư/khóa công khai.
- `c=relaxed/relaxed`: Trường "c=" chỉ ra thuật toán giảm thiểu (canonicalization) được sử dụng. Nó cho biết liệu có sự thay đổi trong email liên quan đến khoảng trắng hoặc dòng mới. Giá trị đầu tiên trước "/" ám chỉ phần tiêu đề và phần còn lại ám chỉ phần thân email.
- `d=gmail.com`: Trường "d=" đại diện cho miền email của người gửi.
- `s=20161025pm`: Trường "s=" tham chiếu đến bộ chọn (selector) để xác định khóa DKIM công khai.
- `bh=RqIJ8naev02DhEPJtlFAsdUqiGR7RyzmJ9cSxw5KzCY=`: Đây là giá trị băm cho phần thân email theo thuật toán băm được sử dụng và sau đó được mã hóa theo chuẩn Base64.
- `b=`: Trường này chứa chữ ký DKIM được tính toán theo trường tiêu đề được cung cấp trong trường "h=".

### Phân tích Email Headers: X-Headers

X-Headers là các mục tiêu không chuẩn trong tiêu đề email có thể được tùy chỉnh và gửi kèm với email để thu thập thông tin cụ thể quan trọng đối với người gửi. Những tiêu đề này thường được các nhà cung cấp hộp thư điện tử bao gồm để thu thập thông tin bộ lọc thư rác và kết quả xác thực. Một số nhà cung cấp dịch vụ email cho phép người dùng chèn dữ liệu vào X-Headers, giúp theo dõi các chỉ số liên quan đến số lượng email đã gửi, số lượng email bị trả lại, số lượng email đã mở và nội dung đã được nhấp. Theo dõi và báo cáo các chỉ số email này là rất quan trọng để quản lý giao hàng email một cách hiệu quả.

X-Headers thường bắt đầu bằng chữ "X" để chỉ ra rằng chúng là các phần mở rộng cho các tiêu đề chuẩn.

#### Dưới đây là một ví dụ về X-Headers:

Delivered-To: someone@gmail.com
Received: by 20.13.192.17 with SMTP id 123csp12292736jad;
Fri, 15 Nov 2019 05:30:17 -0800 (PST)
X-Received: by 49.36.128.219 with SMTP id x195mr7643240oix.178.1573824617320;
Fri, 15 Nov 2019 05:30:17 -0800 (PST)

Trong ví dụ trên, tiêu đề X-Received cung cấp thông tin như địa chỉ IP của máy chủ nhận, ID SMTP của máy chủ và thời gian gắn liền với email.

#### Dưới đây là một số ví dụ khác về X-Headers:

- X-originating-ID:
   Nó phản ánh địa chỉ IP ban đầu của email hoặc người gửi. Nó khó để giả mạo.

- X-Mailer:
   Nó chỉ ra khách hàng email đã được sử dụng để gửi tin nhắn. Tuy nhiên, nó có thể bị giả mạo dễ dàng.

-  X-Apparently-To:
   Thông thường hiển thị khi tin nhắn được gửi đến nhiều người nhận hoặc danh sách gửi thư.

-  X-Sieve:
   Nó phản ánh tên và phiên bản của hệ thống lọc tin nhắn đang sử dụng.

-  X-Delivered-To:
   Nó phản ánh địa chỉ hộp thư nơi máy chủ gửi đã giao tin nhắn email.

Những X-Headers này cung cấp thông tin bổ sung về email, nguồn gốc và các hệ thống xử lý hoặc lọc phù hợp liên quan.

### Phân tích tiêu đề Email: Kiểm tra tính xác thực của Email

Một địa chỉ email hợp lệ là một địa chỉ mà email có thể được gửi thành công. Nó có thể xác thực danh tính của một người hoặc một thực thể/tổ chức.

Nếu các nhà điều tra pháp y gặp một địa chỉ email đáng ngờ trong quá trình điều tra tiêu đề email, họ nên sử dụng các công cụ trực tuyến như Email Dossier để xác minh tính xác thực của địa chỉ email.

#### Email Dossier

Nguồn: https://centralops.net

Công cụ này cung cấp một trường để nhập địa chỉ email để xác minh tính hợp lệ của nó. Công cụ cung cấp thông tin về địa chỉ email, bao gồm các bản ghi trao đổi thư.

Email Dossier khởi tạo phiên SMTP để kiểm tra sự chấp nhận của địa chỉ email, nhưng nó không gửi thực sự một email. Khi một địa chỉ email hợp lệ/xác thực, công cụ cung cấp các thông tin sau:

- Hiển thị kết quả "3 - SMTP" trong trường "confidence rating".
- Hiển thị các bản ghi Mail Exchange (MX) với các trường ưu tiên, trao đổi và địa chỉ IP.
- Công cụ cũng hiển thị các phiên SMTP mà nó khởi tạo để kiểm tra việc chấp nhận địa chỉ email.

Một số công cụ khác để kiểm tra tính xác thực của địa chỉ email là như sau:

#### Email Address Verifier

Nguồn: https://tools.verifyemailaddress.io

Công cụ xác minh email này thiết lập kết nối với hộp thư để xác định xem một địa chỉ email có tồn tại không.

#### Email Checker

Nguồn: http://email-checker.net

Công cụ này cung cấp một trường để nhập địa chỉ email để kiểm tra tính hợp lệ của nó. Công cụ này truy xuất các bản ghi trao đổi thư từ địa chỉ email và kết nối đến máy chủ thư để xác minh rằng một hộp thư cụ thể tồn tại cho địa chỉ email đã cho.

#### G-Lock Software Email Verifier

Nguồn: http://www.glocksoft.com

Công cụ này quét từng địa chỉ email được cung cấp từ danh sách gửi thư hoặc cơ sở dữ liệu để xác minh xem địa chỉ email có hợp lệ không.

### Phân tích tiêu đề Email: Khám phá địa chỉ IP nguồn

Trong quá trình phân tích tiêu đề của một email đáng ngờ, các nhà điều tra cần xác định địa chỉ IP của máy chủ thư mà email được gửi từ để tìm ra kẻ tấn công. Để làm điều này, các nhà điều tra có thể sử dụng các cơ sở dữ liệu trực tuyến như cơ sở dữ liệu Whois hoặc các trang web như whatismyipaddress.com. Sau đó, họ có thể tìm địa chỉ địa lý của người gửi trong cơ sở dữ liệu.

#### Cơ sở dữ liệu Smart Whois

Nguồn: https://whois.urih.com

Cơ sở dữ liệu Smart Whois là một cơ sở dữ liệu công khai chứa thông tin liên quan đến chủ sở hữu hoặc người liên hệ của mỗi tên miền và dữ liệu máy chủ.

#### Whatismyipaddress

Nguồn: www.whatismyipaddress.com

whatismyipaddress.com chứa một phần tra cứu địa chỉ IP thông qua đó các nhà điều tra có thể xác định địa chỉ IPv4 hoặc IPv6 của một người dùng Internet hoặc có ý tưởng về phần nào của quốc gia hoặc thế giới mà họ đang ở.

### Điều tra một Email Đáng Ngờ

Nếu một email được xác định là đáng ngờ, các phần chính của nó, bao gồm trường chủ đề, nội dung email, tiêu đề email như các tiêu đề nhận được, Received-SPF và Message ID, phải được kiểm tra kỹ lưỡng để điều tra và xác định xem email có phải là độc hại hay giả mạo/huỷ diệt.

Dưới đây là một số thành phần mà các nhà điều tra phải xem xét để hiểu xem một tin nhắn email có thật hay giả mạo:

#### 1. Kiểm tra Nội dung Email

Trong quá trình kiểm tra một tin nhắn email đáng ngờ, các nhà điều tra phải chú ý theo dõi chủ đề của email, nội dung email và tệp đính kèm để trích xuất dữ liệu có giá trị chứng cứ. Ảnh chụp màn hình dưới đây cho thấy một tin nhắn email với dòng chủ đề được viết theo cách sẽ tạo ra sự khẩn cấp đối với người nhận và do đó, thao tác người đọc để nhấp vào email và đọc tin nhắn.

Ngoài ra, phần thân email chứa một liên kết đến trang đăng nhập Twitter. Tuy nhiên, khi di chuột qua liên kết được cung cấp, một địa chỉ IP (10.0.0.32) xuất hiện ở góc dưới bên trái của cửa sổ email, trông đáng ngờ vì nó giống như một địa chỉ IP riêng tư.

##### 2. Kiểm tra Liên kết

Nếu phát hiện bất kỳ liên kết đáng ngờ nào trong thân email, nhà điều tra có thể kiểm tra liên kết bằng cách mở nó trong một môi trường pháp y kiểm soát.

Ảnh chụp màn hình dưới đây cho thấy rằng khi nhấp vào liên kết, nó sẽ chuyển hướng đến một trang web, trong đó trình duyệt hiển thị "10.0.0.32/explore" trong không gian URL thay vì URL cho trang đăng nhập Twitter.

Trang được mở, tuy nhiên, chứa các trường để nhập tên người dùng và mật khẩu Twitter. Nếu người dùng mục tiêu cung cấp nhầm thông tin đăng nhập của mình, kẻ tấn công sẽ có được thông tin trên máy tấn công của họ.


#### 3. Phân tích các Mục tiêu Tiêu đề Nhận được

Để tìm thông tin về máy chủ email, địa chỉ IP và tên máy chủ được sử dụng bởi kẻ tấn công/người gửi, nhà điều tra cần xem xét các mục tiêu tiêu đề nhận được trong tiêu đề email. Chi tiết về tên máy chủ, máy chủ email và địa chỉ IP được sử dụng bởi kẻ tấn công được tiết lộ trong tiêu đề nhận được ở dưới cùng.
Ảnh chụp màn hình trên phản ánh nội dung của mục tiêu tiêu đề nhận được cuối cùng, cho thấy rằng tin nhắn email được khởi tạo từ một trang web có tên là emkei.cz với địa chỉ IP là 93.99.104.210. Tên trang web và địa chỉ IP hiển thị này nên gây nghi ngờ, vì các phát hiện này là các chỉ báo mạnh về việc giả mạo email.

#### 4. Xem xét Địa chỉ IP Khởi tạo

Các nhà điều tra có thể nghiên cứu sâu hơn về địa chỉ IP được lấy từ mục tiêu tiêu đề nhận được trên trang web whatismyipaddress.com.
Ảnh chụp màn hình trên lại xác nhận rằng địa chỉ IP thuộc về tên máy chủ emkei.cz. Nó được liên kết với một tổ chức có tên Liberty Global, có trụ sở tại Czechia, châu Âu. Các phát hiện này tiếp tục chỉ ra sự giả mạo email.

#### 5. Kiểm tra Trường Received-SPF

Các nhà điều tra cũng nên xem xét trường tiêu đề Received-SPF để kiểm tra xem có bất kỳ lỗi xác thực SPF nào không.
Ảnh chụp màn hình trên cho thấy trường Received-SPF hiển thị kết quả "softfail", điều này có nghĩa là miền của jose.regan@gmail.com (ID email của người gửi như được hiển thị trong email) không ủy quyền địa chỉ IP 93.99.104.210 để gửi email thay mặt. Sự thất bại này trong xác thực là một chỉ báo khác về việc giả mạo email.

#### 6. Kiểm tra tính hợp lệ của Email người gửi

Sau khi có được ID email của người gửi, nhà điều tra nên sử dụng Email Dossier để xác minh xem địa chỉ email của người gửi như được hiển thị trong tin nhắn có đúng không.


Ảnh chụp màn hình trên được lấy từ Email Dossier, cho thấy địa chỉ email là hợp lệ. Với kết quả này, nhà điều tra có thể xác định rằng tài khoản email của người dùng có tên Jose Regan có thể đã bị kẻ tấn công chiếm đoạt, hoặc ID đã được thu thập thông qua các kỹ thuật kỹ nghệ xã hội.

#### 7. Phân tích Message ID

Phân tích Message ID cũng là một phần quan trọng trong cuộc điều tra, vì nó giúp xác định tính xác thực của email.
Ảnh chụp màn hình dưới đây nhấn mạnh Message ID và cho thấy tên miền đầy đủ (FQDN) hiển thị là "localhost" thay vì mail.gmail.com (là FQDN cho Gmail). Phát hiện này chứng minh khả năng email đã bị giả mạo.

### Bước 6: Khôi phục các tin nhắn email đã xóa

Quá trình khôi phục một tin nhắn email đã bị xóa phụ thuộc vào ứng dụng email được sử dụng để gửi email:

- Khôi phục các tin nhắn email đã xóa từ Outlook PST

  Trong Outlook, các tin nhắn email sau khi bị xóa sẽ được chuyển vào thư mục "Deleted Items" (Mục đã xóa). Các email đã xóa được lưu trong thư mục "Deleted Items" trong vòng 14 ngày (một khoảng thời gian giữ nguyên mặc định có thể chỉnh sửa), sau đó các tin nhắn sẽ tự động bị xóa khỏi thư mục đó. Trong trường hợp các email đã xóa này cũng bị xóa khỏi thư mục này, chúng sẽ trở thành vô hình đối với người dùng. Tuy nhiên, chúng không hoàn toàn bị xóa mà chỉ được chuyển đến không gian không được cấp phát trên ổ đĩa. Các tin nhắn email đã xóa có thể được khôi phục nếu không ghi đè không gian không được cấp phát này bằng dữ liệu mới. Các email này có thể được khôi phục bằng các công cụ pháp y như Paraben’s Electronic Evidence Examiner (E3), nếu chưa bị ghi đè.

- Khôi phục các tin nhắn email đã xóa từ Thunderbird

  Thunderbird lưu trữ các tin nhắn email đã bị người dùng xóa trong thư mục "Trash" (Thùng rác). Thư mục "Trash" lưu trữ các tin nhắn email đã xóa cho đến khi chúng được xóa hoàn toàn. Các công cụ pháp y như Paraben’s Electronic Evidence Examiner (E3) có thể khôi phục các tin nhắn email đã xóa này tùy thuộc vào thời điểm khôi phục được thực hiện. Nếu bất kỳ tin nhắn email nào được lưu trữ trong thư mục Thùng rác Cục bộ của Thunderbird bị xóa, việc khôi phục hoàn toàn là có thể.

Các nhà điều tra pháp y có thể khôi phục dữ liệu email bị xóa vĩnh viễn từ các tệp .pst của Outlook và Thunderbird bằng cách sử dụng các công cụ như Paraben’s Electronic Evidence Examiner. Ở đây, dữ liệu email bị xóa vĩnh viễn đề cập đến các tin nhắn email đã bị xóa hoặc bị mất khỏi thư mục "Deleted Items" trong Outlook và các tin nhắn đã bị xóa hoặc bị mất khỏi thư mục "Trash" cũng như thư mục "Local Trash" của Thunderbird.

#### Paraben's Electronic Evidence Examiner

Nguồn: https://paraben.com

E3 là một công cụ phân tích pháp y kỹ thuật số toàn diện được thiết kế để xử lý dữ liệu hiệu quả hơn trong quá trình khám phá pháp y với sự tuân thủ nguyên tắc P2 Paradigm của Paraben về tập trung chuyên môn vào toàn bộ quy trình khám phá pháp y. Nền tảng E3 sử dụng kiến trúc plug-in tiên tiến của Paraben để tạo ra các công cụ đặc biệt để khám phá các yếu tố như email, email mạng, nhật ký trò chuyện, dữ liệu di động, hệ thống tệp và phân tích tệp Internet - đồng thời tăng khả năng xử lý dữ liệu và tận dụng tài nguyên thông qua việc đa luồng và lập lịch công việc. Electronic Evidence Examiner không chỉ giá cả phải chăng mà còn chạy hiệu quả với yêu cầu phần cứng thấp hơn.
